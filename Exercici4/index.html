<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sant Pere de Vallhonesta</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/examples/js/controls/OrbitControls.js"></script>
</head>
<body>
    <!-- Menú fix a la part superior -->
    <nav class="navbar">
        <ul>
            <li><a href="#fotos">Fotos</a></li>
            <li><a href="#historia">Història</a></li>
            <li><a href="#videos">Vídeos 3D</a></li>
            <li><a href="#com-arribar">Com Arribar-hi</a></li>
        </ul>
    </nav>

    <!-- Secció de Fotos -->
    <section id="fotos" class="section">
        <h2>Fotos</h2>
        <div class="photo-gallery">
            <div class="photo"><img src="imatges/foto1.jpg" alt="Foto 1"></div>
            <div class="photo"><img src="imatges/foto2.jpg" alt="Foto 2"></div>
            <div class="photo"><img src="imatges/foto3.jpg" alt="Foto 3"></div>
        </div>
    </section>

    <!-- Secció d'Història -->
    <section id="historia" class="section">
        <h2>Història</h2>
        <p>L'Ermita de Sant Pere de Vallhonesta, situada al municipi de Sant Vicenç de Castellet, és un destacat exemple d'arquitectura romànica amb una història que es remunta al segle XI...</p>
    </section>

    <!-- Secció de Vídeos 3D -->
    <section id="videos" class="section">
        <h2>Vídeos 3D</h2>
        <div id="video-360" class="video-container"></div>
    </section>

    <!-- Secció Com Arribar-hi -->
    <section id="com-arribar" class="section">
        <h2>Com Arribar-hi</h2>
        <div class="map-container">
            <iframe src="https://www.google.com/maps/embed?pb=EXEMPLE_MAPA" frameborder="0" allowfullscreen></iframe>
        </div>
    </section>

    <!-- Footer (buit de moment) -->
    <footer></footer>

    <script>
        // Crear escena 3D
        var scene = new THREE.Scene();
        var camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        var renderer = new THREE.WebGLRenderer();
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.getElementById('video-360').appendChild(renderer.domElement);

        // Crear una esfera per mostrar el vídeo
        var geometry = new THREE.SphereGeometry(500, 60, 40);
        geometry.scale(-1, 1, 1); // Invertir la esfera perquè el vídeo s'hi vegi des de dins

        var video = document.createElement('video');
        video.src = 'videos/Vallhonesta.mp4'; // Ruta del vídeo 360
        video.load();
        video.autoplay = true;
        video.loop = true;
        video.muted = true;

        video.oncanplay = function() {
            console.log('El vídeo s’ha carregat correctament');

            // Crear la textura del vídeo
            var texture = new THREE.VideoTexture(video);
            var material = new THREE.MeshBasicMaterial({ map: texture });
            var sphere = new THREE.Mesh(geometry, material);
            scene.add(sphere);

            // Col·locar la càmera a una distància adequada
            camera.position.set(0, 0, 0.1); // Col·locar la càmera dins l'esfera

            // Control de la càmera per navegar
            var controls = new THREE.OrbitControls(camera, renderer.domElement);

            // Funció d'animació
            var animate = function () {
                requestAnimationFrame(animate);
                controls.update();
                renderer.render(scene, camera);
            };

            animate();
        };

        // Gestionar errors en carregar el vídeo
        video.onerror = function() {
            console.error('Error carregant el vídeo');
        };
    </script>
</body>
</html>
